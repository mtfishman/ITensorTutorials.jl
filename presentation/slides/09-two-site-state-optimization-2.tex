\begin{frame}[fragile]{Tutorial: Two-site state optimization}

\begin{columns}

\begin{column}{5cm}

\begin{onlyenv}<1->
\begin{lstlisting}[language=JuliaLocal, style=julia, mathescape, basicstyle=\small]
$\psi_0$ = (Zp1 * Zm2 +
         Zm1 * Zp2)/√2

E($\psi_0$)

using Zygote: gradient
$\partial$E($\psi$) = gradient(E, $\psi$)[1]

norm($\partial$E($\psi_0$))
\end{lstlisting}
\end{onlyenv}

\begin{onlyenv}<3->
\begin{lstlisting}[language=JuliaLocal, style=julia, mathescape, basicstyle=\small]
$\psi$ = minimize(E, $\partial$E, $\psi_0$;
       nsteps=10, $\gamma$=0.1)

E($\psi_0$), norm($\partial$E($\psi_0$))
E($\psi$), norm($\partial$E($\psi$))
 \end{lstlisting}
\end{onlyenv}

\end{column}

\begin{column}{5cm}

\begin{onlyenv}<1-1>
|$\psi_0\rangle$ = (|Z+Z+$\rangle$ + \\
           |Z-Z-$\rangle$)/√2 \\
~\\
$\approx$ -1 \\
~\\
Using Zygote for automatic \\
differentation of the energy. \\
~\\
$\approx$ 2 \\
\end{onlyenv}

\begin{onlyenv}<2->
\vspace*{0.0cm}
\begin{center}
\includegraphics[width=0.2\textwidth]{
  slides/assets/psi12Hpsi12.png
}
\end{center}
\vspace*{0.0cm}
\end{onlyenv}

\begin{onlyenv}<3-3>
Minimize over $\psi$: \\
E($\psi$) = $\langle\psi$|H|$\psi\rangle$/$\langle\psi$|$\psi\rangle$ \\
~\\
(-1, 2) \\
(-1.4142131, 0.0010865277) \\
       $\approx$ (-√2, 0)
\end{onlyenv}

\begin{onlyenv}<4->
\vspace*{0.0cm}
\begin{center}
\includegraphics[width=0.2\textwidth]{
  slides/assets/min_grad_E_psi.png
}
\end{center}
\vspace*{0.0cm}
\end{onlyenv}

\end{column}

\end{columns}

\end{frame}
