\begin{frame}[fragile]{Tutorial: n-site operators with MPO}

\begin{columns}

\begin{column}{5cm}

\begin{onlyenv}<1->
\begin{lstlisting}[language=JuliaLocal, style=julia, mathescape, basicstyle=\small]
function ising(n; h)
  H = OpSum()
  for j in 1:(n - 1)
    H -= "Z", j, "Z", j + 1
  end
  for j in 1:n
    H += h, "X", j
  end
  return H
end
\end{lstlisting}
\end{onlyenv}

\begin{onlyenv}<3->
\begin{lstlisting}[language=JuliaLocal, style=julia, mathescape, basicstyle=\small]
h = 0.5
H = MPO(ising(n; h=h), i)
maxlinkdim(H)
Zp = MPS(i, "Z+")
inner(Zp', H, Zp)
 \end{lstlisting}
\end{onlyenv}

\end{column}

\begin{column}{5.5cm}

\begin{onlyenv}<1-1>
$n$ sites \\
$H = -\sum_j^{n-1} Z_j Z_{j+1} + h \sum_j^n X_j$ \\
~\\
~\\
~\\
~\\
~\\
~\\
~\\
~\\
\end{onlyenv}

\begin{onlyenv}<2->
\vspace*{0.0cm}
\begin{center}
\includegraphics[width=0.3\textwidth]{
  slides/assets/isingn.png
}
\includegraphics[width=0.3\textwidth]{
  slides/assets/isingn_mpo.png
}
\includegraphics[width=0.3\textwidth]{
  slides/assets/Zpn_H_Zpn.png
}
\end{center}
\vspace*{0.0cm}
\end{onlyenv}

\begin{onlyenv}<3->
~\\
~\\
= 3 (local Hamiltonian) \\
~\\
$\langle$Z+Z+…Z+|H|Z+Z+…Z+$\rangle$ \\
  $\approx$ -(n - 1) = -29
\end{onlyenv}

\end{column}

\end{columns}

\end{frame}
